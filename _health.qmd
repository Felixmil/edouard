{{< include _setup.qmd >}}

## üè• Sant√©


### Temp√©ratures

```{r}
temp_data <- get_temperature_data(data)

if (nrow(temp_data) > 0) {
  colors <- edouard_colors()

  temp_data |>
    mutate(
      has_notes = !is.na(notes)
    ) |>
    ggplot(aes(x = datetime, y = value)) +
    # Zone bleue pour temp√©ratures trop basses (< 36.5¬∞C)
    annotate(
      "rect",
      xmin = min(temp_data$datetime),
      xmax = max(temp_data$datetime),
      ymin = -Inf,
      ymax = 36.5,
      fill = "blue",
      alpha = 0.1
    ) +
    # Zone rouge pour temp√©ratures trop √©lev√©es (> 37.5¬∞C)
    annotate(
      "rect",
      xmin = min(temp_data$datetime),
      xmax = max(temp_data$datetime),
      ymin = 37.5,
      ymax = Inf,
      fill = "red",
      alpha = 0.1
    ) +
    # Courbe de tendance
    geom_smooth(
      method = "loess",
      span = 0.3,
      color = "grey60",
      fill = "grey60",
      alpha = 0.2,
      linewidth = 1
    ) +
    # Points de mesure
    geom_point(
      aes(color = has_notes),
      fill = "grey40",
      size = 2.5,
      stroke = 1,
      shape = 21
    ) +
    scale_color_manual(
      values = c("TRUE" = "black", "FALSE" = "grey40"),
      guide = "none"
    ) +
    scale_x_datetime(date_labels = "%d %b") +
    labs(
      y = "Temp√©rature (¬∞C)",
      x = NULL
    ) +
    theme_minimal() +
    theme(
      panel.grid.minor = element_blank()
    )
} else {
  cat("Aucune donn√©e de temp√©rature √† afficher.")
}
```


### √âv√©nements m√©dicaux et sympt√¥mes

```{r}
medical_data <- data |>
  dplyr::filter(variable %in% c("evenement_medical", "symptome")) |>
  dplyr::arrange(dplyr::desc(datetime))

if (nrow(medical_data) > 0) {
  medical_data |>
    dplyr::select(datetime, variable_label, notes) |>
    reactable(
      sortable = TRUE,
      searchable = TRUE,
      columns = list(
        datetime = colDef(
          name = "Date et heure",
          format = colFormat(datetime = TRUE)
        ),
        variable_label = colDef(name = "Type"),
        notes = colDef(name = "Description")
      )
    )
} else {
  cat("Aucun √©v√©nement m√©dical ou sympt√¥me enregistr√©.")
}
```
